# –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ - –ó–∞–≤–µ—Ä—à–µ–Ω–æ! ‚úÖ

## üìã –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–∏–ø—ã

**–§–∞–π–ª:** `src/entities/session/api/types.ts`

‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è:
- `middle_name` - –æ—Ç—á–µ—Å—Ç–≤–æ
- `password_confirm` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
- `store_city` - –≥–æ—Ä–æ–¥ –º–∞–≥–∞–∑–∏–Ω–∞
- `store_region` - —Ä–µ–≥–∏–æ–Ω –º–∞–≥–∞–∑–∏–Ω–∞
- `store_legal_name` - —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
- `store_tax_id` - –ò–ù–ù –º–∞–≥–∞–∑–∏–Ω–∞

‚úÖ –°–æ–∑–¥–∞–Ω —Ç–∏–ø `AuthResponse` –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ —Å –±—ç–∫–µ–Ω–¥–∞ (–≤–∫–ª—é—á–∞–µ—Ç `tenant_key`)

‚úÖ –°–æ–∑–¥–∞–Ω —Ç–∏–ø `LoginData` –¥–ª—è –ª–æ–≥–∏–Ω–∞

---

### 2. –û–±–Ω–æ–≤–ª—ë–Ω sessionApi

**–§–∞–π–ª:** `src/entities/session/api/sessionApi.ts`

‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã endpoints:
- `/users/register/` ‚Üí `/users/auth/register/`
- `/users/login/` ‚Üí `/users/auth/login/`
- `/users/token/refresh/` ‚Üí `/users/auth/token/refresh/`

‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤:
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `access_token`
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `refresh_token`
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `tenant_key`** ‚≠ê
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `user`, `store`, `employee` –≤ localStorage

---

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

**–§–∞–π–ª:** `src/features/Auth/Register/ui/RegisterForm.tsx`

‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–æ–ª—è:
- **–û—Ç—á–µ—Å—Ç–≤–æ** (middle_name)
- **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è** (password_confirm)
- **–ì–æ—Ä–æ–¥ –º–∞–≥–∞–∑–∏–Ω–∞** (store_city)
- **–†–µ–≥–∏–æ–Ω –º–∞–≥–∞–∑–∏–Ω–∞** (store_region)
- **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ** (store_legal_name) - –≤ —Å–∫—Ä—ã–≤–∞–µ–º–æ–π —Å–µ–∫—Ü–∏–∏
- **–ò–ù–ù –º–∞–≥–∞–∑–∏–Ω–∞** (store_tax_id) - –≤ —Å–∫—Ä—ã–≤–∞–µ–º–æ–π —Å–µ–∫—Ü–∏–∏

‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π

‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- –ü–æ–∫–∞–∑ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å –±—ç–∫–µ–Ω–¥–∞
- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

---

### 4. –û–±–Ω–æ–≤–ª—ë–Ω Login API hook

**–§–∞–π–ª:** `src/features/Auth/Login/api/useLogin.ts`

‚úÖ –£–ø—Ä–æ—â—ë–Ω –∫–æ–¥ (–ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ sessionApi)

‚úÖ `tenant_key` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ

---

## üîë –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ tenant_key

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–ª–∏ –ª–æ–≥–∏–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:

```typescript
localStorage:
  - access_token
  - refresh_token
  - tenant_key  // ‚≠ê –í–ê–ñ–ù–û!
  - user (JSON)
  - store (JSON)
  - employee (JSON)
```

### –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

```typescript
{
  // –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  first_name: string;
  last_name?: string;
  middle_name?: string;  // ‚≠ê –ù–æ–≤–æ–µ
  owner_phone: string;
  email?: string;

  // –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞
  username: string;
  password: string;
  password_confirm: string;  // ‚≠ê –ù–æ–≤–æ–µ

  // –î–∞–Ω–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω–∞
  store_name: string;
  store_address: string;
  store_city?: string;  // ‚≠ê –ù–æ–≤–æ–µ
  store_region?: string;  // ‚≠ê –ù–æ–≤–æ–µ
  store_phone: string;
  store_email?: string;
  store_legal_name?: string;  // ‚≠ê –ù–æ–≤–æ–µ
  store_tax_id?: string;  // ‚≠ê –ù–æ–≤–æ–µ
  store_description?: string;
}
```

### –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞

```typescript
{
  status: "success",
  data: {
    user: {...},
    store: {
      id: 1,
      name: "–°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç –ê–∑–∏—è",
      tenant_key: "asia_market_a3f4b2c1"  // ‚≠ê –í–ê–ñ–ù–û!
    },
    employee: {...},
    tokens: {
      access: "...",
      refresh: "..."
    }
  }
}
```

---

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### –ó–∞–ø—É—Å–∫ backend

```bash
cd /Users/akkanat/Projects/erp_v2/new_backend
source venv/bin/activate
python manage.py runserver
```

### –ó–∞–ø—É—Å–∫ frontend

```bash
cd /Users/akkanat/Projects/erp_v2/new_frontend
npm run dev
```

### –¢–µ—Å—Ç–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

1. –û—Ç–∫—Ä—ã—Ç—å http://localhost:5173
2. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É:
   - **–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –ò–≤–∞–Ω, –ü–µ—Ç—Ä–æ–≤, –°–µ—Ä–≥–µ–µ–≤–∏—á, +998901234567
   - **–õ–æ–≥–∏–Ω**: ivan_owner
   - **–ü–∞—Ä–æ–ª—å**: SecurePass123!
   - **–ú–∞–≥–∞–∑–∏–Ω**: –°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç –ê–∑–∏—è, —É–ª. –ù–∞–≤–æ–∏ –¥. 45, –¢–∞—à–∫–µ–Ω—Ç
   - **–¢–µ–ª–µ—Ñ–æ–Ω –º–∞–≥–∞–∑–∏–Ω–∞**: +998712345678
4. –ù–∞–∂–∞—Ç—å "Ro'yxatdan o'tish"
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
   - –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é
   - tenant_key –≤ localStorage
   - –¢–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã

### –¢–µ—Å—Ç–æ–≤—ã–π –ª–æ–≥–∏–Ω

1. –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–æ–≥–∏–Ω–∞
2. –í–≤–µ—Å—Ç–∏ credentials
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ tenant_key

---

## üìù –ß—Ç–æ –¥–∞–ª—å—à–µ

### –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è - –≥–æ—Ç–æ–≤–∞
2. ‚úÖ –õ–æ–≥–∏–Ω - –≥–æ—Ç–æ–≤
3. ‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ - —Ç—Ä–µ–±—É–µ—Ç –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
4. ‚è≥ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã - —Ç—Ä–µ–±—É—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
5. ‚è≥ –®—Ç—Ä–∏—Ö–∫–æ–¥—ã - —Ç—Ä–µ–±—É—é—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

### tenant_key —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!

–ë–ª–∞–≥–æ–¥–∞—Ä—è –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–º—É `authInterceptor.ts`, –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Tenant-Key` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ –≤—Å–µ–º –∑–∞–ø—Ä–æ—Å–∞–º (–∫—Ä–æ–º–µ auth —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤).

**–ë–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–ª—è—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫!**

```typescript
// ‚ùå –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±
fetch('/api/products/', {
  headers: {
    'Authorization': `Bearer ${token}`,
    'X-Tenant-Key': tenantKey  // –í—Ä—É—á–Ω—É—é
  }
});

// ‚úÖ –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–±
api.get('/products/products/');
// X-Tenant-Key –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
```

---

## üéâ –ò—Ç–æ–≥–æ

**–§–æ—Ä–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ –Ω–æ–≤—ã–π –±—ç–∫–µ–Ω–¥!**

- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –æ–¥–Ω–æ–º –æ–∫–Ω–µ
- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∏ –º–∞–≥–∞–∑–∏–Ω–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ tenant_key
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (—Ç–æ–≤–∞—Ä—ã, –ø—Ä–æ–¥–∞–∂–∏ –∏ —Ç.–¥.)
